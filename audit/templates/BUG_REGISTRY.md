# Bug Registry Template

Use one row per bug.

| Bug ID      | Severity    | Area                   | Journey                             | File/Module                                                                                                                                                                            | Repro Steps                                                                                                             | Expected                                                                                                           | Actual                                                                                                                                                                                                           | Root Cause                                                                                                                                         | Fix Plan                                                                                                                                                                                    | Owner                                                                            | Status                                                                | Evidence                                                                                                                                                                                                                                                                         |
| ----------- | ----------- | ---------------------- | ----------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------- | --------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------- | ----------------------------------------------------------- | ----- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| WG-AUD-0001 | P0-Critical | FE-BE Contract         | Super Admin multi-tenant routing    | `client/src/api/index.ts`, `nest/src/common/guards/tenant.guard.ts`, `nest/src/common/decorators/tenant-id.decorator.ts`                                                               | 1) Login as SUPER_ADMIN 2) Select tenant in UI 3) Request `/products`                                                   | Selected tenant context should be applied server-side                                                              | Backend tenant resolver only reads `request.tenantId` or `x-tenant-id`; frontend sends query `tenantId` only                                                                                                     | Tenant context propagation mismatch between frontend interceptor and backend tenant guard                                                          | Add unified tenant resolver that accepts header and validated query/source, and standardize one transport contract                                                                          | Audit                                                                            | Fixed                                                                 | `client/src/api/index.ts:94`, `nest/src/common/guards/tenant.guard.ts:46`, `nest/src/common/decorators/tenant-id.decorator.ts:17`                                                                                                                                                |
| WG-AUD-0002 | P0-Critical | Auth/Shift             | Cashier shift gate                  | `nest/src/modules/cash-shifts/cash-shifts.controller.ts`, `client/src/stores/auth.ts`, `client/src/router/index.ts`                                                                    | 1) Cashier without active shift calls `/cash-shift/current` 2) Navigate protected route                                 | User without active shift must be redirected to open shift                                                         | API returns `{ message: 'No active shift' }` with 200; frontend treats object as active shift due `!shiftStatus                                                                                                  |                                                                                                                                                    | shiftStatus.shiftEnd` logic                                                                                                                                                                 | Contract mismatch for no-shift state (null/404 expected by frontend cache logic) | Normalize API to explicit no-shift contract and align guard condition | Audit                                                                                                                                                                                                                                                                            | Fixed                                     | `nest/src/modules/cash-shifts/cash-shifts.controller.ts:72` |
| WG-AUD-0003 | P1-Major    | Build/Dependency       | Backend installation                | `nest/package.json`                                                                                                                                                                    | 1) Run `npm ci` in `nest/` on clean machine                                                                             | Dependencies install cleanly                                                                                       | `npm ci` fails with peer conflict `@nestjs/serve-static@5.0.4` requiring Nest 11                                                                                                                                 | Version matrix drift between Nest core v10 and serve-static package                                                                                | Pin compatible `@nestjs/serve-static` for Nest 10 and refresh lockfile                                                                                                                      | Audit                                                                            | Fixed                                                                 | `nest/package.json:24`, `nest/package-lock.json`, verified `npm ci` success in `nest/`                                                                                                                                                                                           |
| WG-AUD-0004 | P1-Major    | FE-BE Connectivity     | Local/dev API routing               | `client/src/api/index.ts`, `nest/src/main.ts`, `docker-compose.yml`                                                                                                                    | 1) Start backend default config 2) Start frontend without `VITE_API_URL`                                                | Frontend should call active backend API                                                                            | Frontend default baseURL uses `http://localhost:3001/api` while backend listens on `3000`                                                                                                                        | Default API port drift after backend runtime changes                                                                                               | Unify default ports and enforce via env validation in frontend startup                                                                                                                      | Audit                                                                            | Fixed                                                                 | `client/src/api/index.ts:25`, `nest/src/main.ts:85`, `docker-compose.yml:151`                                                                                                                                                                                                    |
| WG-AUD-0005 | P0-Critical | Security/Auth          | Token verification path             | `nest/src/modules/auth/auth.controller.ts`, `nest/src/modules/auth/auth.service.ts`                                                                                                    | 1) Call `/auth/me` with invalid/missing token 2) Observe auth behavior                                                  | Invalid/missing token should fail consistently (401) with no fallback secrets                                      | `/auth/me` is public and service fallback uses hardcoded JWT secret when env missing                                                                                                                             | Weak auth hardening and inconsistent unauthorized behavior path                                                                                    | Remove fallback secret, make unauthorized explicit, and enforce guard-compatible `/auth/me` semantics                                                                                       | Audit                                                                            | Fixed                                                                 | `nest/src/modules/auth/auth.controller.ts:38`, `nest/src/modules/auth/auth.service.ts:275`                                                                                                                                                                                       |
| WG-AUD-0006 | P1-Major    | Security/Supply Chain  | Frontend dependency health          | `client/package-lock.json`                                                                                                                                                             | 1) Run `npm ci` in `client/` 2) Run `npm audit`                                                                         | Dependency tree should be within accepted risk                                                                     | After `npm audit fix` and toolchain hardening, vulnerabilities are resolved                                                                                                                                      | Transitive dependency risk from minimatch/jspdf chain                                                                                              | Pin patched dependency graph using overrides and updated lockfile                                                                                                                           | Audit                                                                            | Fixed                                                                 | `client/package-lock.json`, `client/package.json:49`, `npm audit --audit-level=high` shows `found 0 vulnerabilities`                                                                                                                                                             |
| WG-AUD-0007 | P2-Minor    | Code Quality           | Frontend maintainability            | `client/src/**`                                                                                                                                                                        | 1) Run `npm run lint`                                                                                                   | Low warning count in critical modules                                                                              | Warning volume remains high (currently 173), mostly unused symbols around POS/layout/report modules                                                                                                              | Refactor debt after reskin and partial feature merges                                                                                              | Continue warning burn-down by module priority (tenant/superadmin/auth first, then POS/reports)                                                                                              | Audit                                                                            | In Progress                                                           | Baseline 2026-02-23: `npm run lint` -> `173 warnings, 0 errors`; focused audited scope reached `0 warnings, 0 errors`; latest global burn-down progress in continuation batch: `131 -> 112` warnings (0 errors)                                                                  |
| WG-AUD-0008 | P1-Major    | Frontend Routing       | App route resolution                | `client/src/router/index.ts`                                                                                                                                                           | 1) Load router with current route table 2) Navigate by named route `stores`                                             | One deterministic route config per route name/path                                                                 | Duplicate named route `stores` appears twice with different role metadata                                                                                                                                        | Route table duplication during reskin merge causing ambiguous/overridden behavior                                                                  | De-duplicate route definitions and keep one canonical `stores` config                                                                                                                       | Audit                                                                            | Fixed                                                                 | `client/src/router/index.ts:297`                                                                                                                                                                                                                                                 |
| WG-AUD-0009 | P0-Critical | Deployment/Runtime     | Environment validation              | Remote runtime service topology                                                                                                                                                        | 1) Check active runtime on target host 2) Probe expected health endpoints                                               | Running runtime should match Warungin service contracts                                                            | Active frontend/backend on host responds as different app contract (Next.js-like frontend and missing expected health routes)                                                                                    | Deployment target drift; runtime not aligned with audited repository                                                                               | Enforce deployment identity checks (service name, commit, endpoint contract) before release audit gates                                                                                     | Audit                                                                            | Fixed                                                                 | Warungin runtime verified healthy on public domains after Coolify deploys `71-76`: `https://warungin.faiznute.site` serves frontend and `https://warungin-api.faiznute.site/health` returns expected identity payload (`appName=warungin-backend`, DB connected)                 |
| WG-AUD-0010 | P0-Critical | Data Integrity         | Order creation pipeline             | `nest/src/modules/orders/orders.service.ts`, `prisma/schema.prisma`                                                                                                                    | 1) Create order via `/orders` with current service path 2) Validate persisted required fields                           | Order record should include required schema fields (`orderNumber`, `userId`, `subtotal`) and match schema contract | Service creates order with partial data and `as any`, bypassing compile checks and risking runtime failure/inconsistent records                                                                                  | Order service implementation drift from Prisma schema + unsafe `any` casting                                                                       | Align create path with schema-required fields and remove unsafe casts on critical writes                                                                                                    | Audit                                                                            | Fixed                                                                 | `nest/src/modules/orders/orders.service.ts:114`, `nest/src/modules/orders/orders.service.ts:120`, `nest/src/modules/orders/orders.service.ts:152`                                                                                                                                |
| WG-AUD-0011 | P0-Critical | Data Integrity         | Stock consistency                   | `nest/src/modules/orders/orders.service.ts`                                                                                                                                            | 1) Create order flow 2) Cancel same order 3) Compare stock                                                              | Stock should return to exact pre-order value                                                                       | Cancel flow always increments stock while no corresponding decrement exists in order creation flow                                                                                                               | Asymmetric stock mutation logic can inflate inventory counts                                                                                       | Introduce symmetric stock reservation/commit model with transaction boundaries                                                                                                              | Audit                                                                            | Fixed                                                                 | `nest/src/modules/orders/orders.service.ts:168`, `nest/src/modules/orders/orders.service.ts:286`                                                                                                                                                                                 |
| WG-AUD-0012 | P1-Major    | Backend Domain Model   | Order lifecycle states              | `nest/src/modules/orders/orders.service.ts`, `prisma/schema.prisma`                                                                                                                    | 1) Execute bulk delete/delete endpoints 2) Persist status                                                               | Status transitions must stay within enum domain                                                                    | Service writes status `DELETED` not present in `OrderStatus` enum                                                                                                                                                | Invalid domain value usage hidden by `as any` can break runtime and reporting                                                                      | Replace soft-delete strategy with valid state model (e.g., cancelled/archive flag)                                                                                                          | Audit                                                                            | Fixed                                                                 | `nest/src/modules/orders/orders.service.ts:506`, `nest/src/modules/orders/orders.service.ts:517`, `prisma/schema.prisma:221`                                                                                                                                                     |
| WG-AUD-0013 | P1-Major    | Payment Reliability    | Callback idempotency                | `nest/src/modules/payments/payments.service.ts`                                                                                                                                        | 1) Receive callback for `order_id` 2) Receive duplicate callback for same payment                                       | Duplicate callbacks should resolve idempotently                                                                    | Lookup key changes from `order_id` to `transaction_id` after first update, breaking repeat callback lookup                                                                                                       | Reference mutation breaks callback idempotency contract                                                                                            | Keep immutable external order reference and store gateway transaction id in separate field                                                                                                  | Audit                                                                            | Fixed                                                                 | `nest/src/modules/payments/payments.service.ts:204`, `nest/src/modules/payments/payments.service.ts:238`                                                                                                                                                                         |
| WG-AUD-0014 | P1-Major    | Reskin Regression      | POS success UX flow                 | `client/src/views/pos/POS.vue`                                                                                                                                                         | 1) Complete payment in POS 2) Observe success overlay rendering                                                         | Exactly one success modal/overlay should render per success state                                                  | Two separate template blocks render on same state `showSuccessOverlay`                                                                                                                                           | Merge artifacts from reskin causing duplicate UI layer behavior                                                                                    | Consolidate to one success overlay component/state path                                                                                                                                     | Audit                                                                            | Fixed                                                                 | `client/src/views/pos/POS.vue:625`, `client/src/views/pos/POS.vue:741`                                                                                                                                                                                                           |
| WG-AUD-0015 | P1-Major    | Performance            | Frontend bundle profile             | `audit/reports/static/20260223-194251/client-build.txt`                                                                                                                                | 1) Build frontend 2) Inspect chunk sizes                                                                                | Critical chunks should remain within performance budget                                                            | Multiple vendor chunks exceed large-size thresholds (e.g. ~540k JS) increasing load time risk                                                                                                                    | Bundle splitting strategy and heavy dependencies not budgeted for cashier-critical flows                                                           | Define bundle budgets and split lazy boundaries for heavy report/pdf/chart dependencies                                                                                                     | Audit                                                                            | Fixed                                                                 | `client/vite.config.js:141`, build output 2026-02-23 shows `jspdf-vendor` 340k and `html2canvas-vendor` 199k                                                                                                                                                                     |
| WG-AUD-0016 | P1-Major    | Deployment Security    | Container privilege boundary        | `docker-compose.yml`                                                                                                                                                                   | 1) Review backend container mounts 2) Assess runtime capabilities                                                       | App container should follow least privilege and avoid host control channels                                        | Backend mounts Docker socket (`/var/run/docker.sock`) even in app runtime                                                                                                                                        | Privilege escalation path and host control surface exposed to app compromise                                                                       | Remove docker socket mount from app runtime or isolate behind dedicated service                                                                                                             | Audit                                                                            | Fixed                                                                 | `docker-compose.yml:177` removed from backend service; only promtail retains docker socket at `docker-compose.yml:332`                                                                                                                                                           |
| WG-AUD-0017 | P2-Minor    | Testing Coverage       | Regression confidence               | `client/cypress/e2e/*.cy.ts`, repo test config                                                                                                                                         | 1) Inventory automated tests 2) Compare against critical journeys                                                       | Critical journeys should be covered by repeatable automated tests                                                  | Coverage still incomplete for full surface, but tenant/customers/orders/finance/retention/reports/analytics plus tenant-detail-user-edit API smoke now validate both unauth guard and authenticated policy paths | Test strategy lagging behind feature and reskin scope                                                                                              | Expand golden-path matrix incrementally; next target UI-driven tenant flows and auth/route guards                                                                                           | Audit                                                                            | In Progress                                                           | Deeper live journeys remain green: payment callback UI `4/4` (malformed-query safety included), customers UI `4/4`, orders UI `4/4`, tenant detail UI `3/3`, finance UI `3/3`; payment webhook API signed check `5/5`; API chained sweep remains green incl. tenant-detail `8/8` |
| WG-AUD-0018 | P1-Major    | FE-BE Contract         | Customer management actions         | `client/src/views/customers/Customers.vue`, `nest/src/modules/customers/customers.controller.ts`                                                                                       | 1) Open `/app/customers` 2) Click "Tambah Poin" then submit 3) Access `/api/customers/export` or `/api/customers/stats` | Quick points should update successfully and static customer endpoints should resolve to their intended handlers    | Quick points sent unsupported field via `PUT /customers/:id` (fails strict DTO validation); `/customers/export` and `/customers/stats` could be shadowed by `GET /customers/:id` route order                     | Frontend action used wrong API contract and backend static routes were declared after dynamic `:id` route                                          | Use `POST /customers/:id/loyalty-points` for quick points and move static `export/stats` routes before `:id`                                                                                | Audit                                                                            | Fixed                                                                 | `client/src/views/customers/Customers.vue:552`, `nest/src/modules/customers/customers.controller.ts:39`, build checks: `nest npm run build`, `client npm run build`, `eslint src/views/customers/Customers.vue`                                                                  |
| WG-AUD-0019 | P2-Minor    | Deployment Reliability | Coolify backend image build         | `Dockerfile.backend`                                                                                                                                                                   | 1) Trigger backend build in Coolify 2) Observe npm install step under network jitter                                    | Backend image build should be resilient and deterministic                                                          | Backend Dockerfile used `npm install` without CI lockfile mode and without network retry tuning, increasing flaky build risk under transient network issues                                                      | Build pipeline not optimized for deterministic/retry-safe dependency resolution in CI                                                              | Add npm fetch retry/timeouts and switch to `npm ci` in both builder/runtime stages                                                                                                          | Audit                                                                            | Fixed                                                                 | `Dockerfile.backend:7`, `Dockerfile.backend:18`, `Dockerfile.backend:37`, `Dockerfile.backend:56`; local `nest npm run build` verified after change                                                                                                                              |
| WG-AUD-0020 | P1-Major    | Deployment Routing     | Coolify source-of-truth integrity   | Coolify app `warungin` (resource `iocgwgwsogcsc0s4k80csc4w`)                                                                                                                           | 1) Push commit to `New-Warungin` 2) Trigger Coolify deploy 3) Inspect source repository in deployment log               | Deployment should fetch from audited repository (`faiznutes/New-Warungin.git`)                                     | Coolify app was configured to pull `faiznutes/Warungins.git`, so fresh fixes from `New-Warungin` were not deployed                                                                                               | Coolify app repository mapping drifted from active engineering repository                                                                          | Update Coolify `applications.git_repository` to `faiznutes/New-Warungin.git` and redeploy                                                                                                   | Audit                                                                            | Fixed                                                                 | Deployment `w4k08k88wgc4kkcgoook00o8` resolved commit `73bf06d...`; live containers use image tag `73bf06d...`; post-deploy smoke run passed (`8 tests, 3 passing, 5 pending, 0 failing`)                                                                                        |
| WG-AUD-0021 | P1-Major    | FE-BE Contract         | Orders list/detail and bulk actions | `nest/src/modules/orders/orders.controller.ts`, `nest/src/modules/orders/orders.service.ts`, `nest/src/modules/orders/dto/get-orders.dto.ts`                                           | 1) Open `/app/orders` and apply search/filter 2) Request `/orders/search` 3) Open order detail or trigger bulk actions  | Orders filters/search/detail/bulk action responses should align with frontend expectations and route contracts     | `/orders` ignored filter/search params, `/orders/search` could be shadowed by `/:id`, detail endpoint returned minimal payload, and bulk refund/delete responses did not match UI response shape                 | Service/query contract drift plus route declaration order mismatch                                                                                 | Add `search` query support in DTO/service, apply full where filters + relation includes, move static routes before `:id`, and return UI-compatible bulk response counters                   | Audit                                                                            | Fixed                                                                 | `nest/src/modules/orders/dto/get-orders.dto.ts:18`, `nest/src/modules/orders/orders.controller.ts:44`, `nest/src/modules/orders/orders.service.ts:40`; checks: `nest npm run build`, `client npm run build`, `orders-page-api.cy.ts` unauth smoke pass                           |
| WG-AUD-0022 | P1-Major    | FE-BE Contract         | Finance transactions listing/export | `client/src/views/finance/Transactions.vue`                                                                                                                                            | 1) Open `/app/finance/transactions` 2) Apply status filter/search 3) Export CSV                                         | Finance transactions should align with `/orders` payload and export consistently                                   | Page expected wrong `/orders` response shape (pagination/status/amount mapping) and depended on non-existent `/orders/export`, causing incorrect stats/filtering and brittle export behavior                     | Frontend assumptions drifted from the current orders API contract                                                                                  | Normalize transactions from orders payload, align status filter values to enum, fetch detail on demand, and export from normalized in-memory dataset                                        | Audit                                                                            | Fixed                                                                 | `client/src/views/finance/Transactions.vue:421`, `client/src/views/finance/Transactions.vue:477`, `client/src/views/finance/Transactions.vue:513`; checks: `eslint src/views/finance/Transactions.vue`, `client npm run build`                                                   |
| WG-AUD-0023 | P1-Major    | FE-BE Contract         | Retention management actions        | `nest/src/modules/retention/*`, `nest/src/app.module.ts`, `client/src/views/settings/RetentionManagement.vue`                                                                          | 1) Open `/app/settings/retention` 2) Load stats 3) Trigger retention action endpoint                                    | Retention routes should exist, be super-admin protected, and return shape expected by current frontend             | Frontend called `/retention/*` endpoints that were not implemented in backend, causing runtime `404` on stats and cleanup actions                                                                                | Missing backend retention module while page was exposed in settings navigation                                                                     | Implement retention module/controller/service, register module in app, and align response payload shape to existing frontend consumption                                                    | Audit                                                                            | Fixed                                                                 | `nest/src/modules/retention/retention.controller.ts:1`, `nest/src/modules/retention/retention.service.ts:1`, `nest/src/app.module.ts:53`; checks: `nest npm run build`, `retention-page-api.cy.ts` live pass (`2 passing`)                                                       |
| WG-AUD-0024 | P1-Major    | FE-BE Contract         | Reports page and export data source | `nest/src/modules/reports/reports.controller.ts`, `nest/src/modules/reports/reports.service.ts`, `client/src/views/reports/Reports.vue`, `client/src/components/ReportExportModal.vue` | 1) Open `/app/reports` 2) Load tenant report 3) Export report from modal                                                | `/reports/tenant` should exist and return report payload shapes consumed by reports page and export modal          | Frontend relied on `/reports/tenant` for both page and export modal, but backend did not expose this endpoint, causing silent data load fallback and export failures                                             | Missing API route and contract implementation for active frontend integration path                                                                 | Implement `GET /reports/tenant` with reportType-period-date handling and payload shapes for `sales                                                                                          | financial                                                                        | product                                                               | customers                                                                                                                                                                                                                                                                        | inventory` plus include-products behavior | Audit                                                       | Fixed | `nest/src/modules/reports/reports.controller.ts:50`, `nest/src/modules/reports/reports.service.ts:14`; checks: `nest npm run build`, `reports-page-api.cy.ts` live pass (`2 passing`) |
| WG-AUD-0025 | P1-Major    | Runtime Reliability    | API error handling under load/proxy | `nest/src/common/dto/response.dto.ts`, `nest/src/common/filters/global-exception.filter.ts`, `nest/src/main.ts`, `nest/src/common/interceptors/performance-monitoring.interceptor.ts`  | 1) Execute high-variance API sweeps behind Cloudflare/proxy 2) Trigger mixed validation/server errors                   | Service should return stable error responses without process crash or duplicate response writes                    | Observed intermittent `502`, `ERR_HTTP_HEADERS_SENT`, and crash signature `Cannot read properties of undefined (reading 'length')`                                                                               | Error payload/exception path not defensive enough + reverse proxy trust config mismatch + interceptor assumed serialized response is always string | Normalize optional error arrays, guard response write when headers already sent, set Express trust proxy before rate limiting, and make performance interceptor tolerate undefined payloads | Audit                                                                            | Fixed                                                                 | Deployed commit `e8c4c7a`; authenticated live specs now pass including customers loyalty points (`customers 4/4`, `tenant-detail 8/8`, `tenant-page 4/4`, `orders 3/3`, `retention 2/2`, `reports 2/2`, `analytics 3/3`)                                                         |
| WG-AUD-0026 | P2-Minor    | Observability          | Health identity provenance          | `nest/src/common/health/health.service.ts`                                                                                                                                             | 1) Deploy new commit 2) Query `/health` identity payload 3) Compare SHA/deployment metadata with actual release         | Health identity should reliably expose active commit and deployment provenance across hosting environments         | `/health` sometimes reports stale/unknown commit SHA even when runtime behavior reflects newer release                                                                                                           | Identity source depended on single env key (`APP_COMMIT_SHA`) while deployment providers may expose commit in different env names                  | Resolve commit from prioritized env key list and expose deployment/container identifiers to improve runtime traceability                                                                    | Audit                                                                            | Fixed                                                                 | Post-deploy verification for commit `c6e6d80`: `/health` now reports `appCommitSha=c6e6d80...` with `commitSource=SOURCE_COMMIT`; `configuredAppCommitSha` remains visible for diagnostics; DB connected                                                                         |

## Status Values

- Open
- In Progress
- Blocked
- Fixed
- Verified
- Closed

## Notes

- Keep repro deterministic.
- If root cause is uncertain, mark as `Needs Investigation`.
- Reference related bugs to avoid duplicate fixes.
