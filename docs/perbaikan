1 — Diagnostic Command (WAJIB)

Gunakan ini dulu. Tanpa ini, kamu cuma menebak-nebak:

TODO:
1. Cari semua location di project yang menggunakan "B" atau "B.value".
2. Tampilkan seluruh deklarasi variable B, tipe awalnya, dan nilai defaultnya.
3. Tampilkan semua assignment ke B.value.
4. Temukan baris tepat di mana ".some()" dipanggil.
5. Tambahkan console.log sebelum pemanggilan ".some()" untuk print:
   - typeof B.value
   - Array.isArray(B.value)
   - isi lengkap B.value
6. Beri laporan lengkap tentang KENAPA B.value bukan array di runtime.

2 — Auto-Fix Command (Setelah hasil diagnosis keluar)

Ini memaksa Cursor untuk memperbaiki masalah sampai selesai, bukan sekedar kasih saran:

TODO:
1. Normalisasi semua assignment ke B.value agar SELALU array.
   - Jika B.value bukan array, ubah menjadi array kosong atau array berisi 1 item.
2. Pastikan deklarasi awal B adalah array default.
3. Tambahkan guard clause di tempat yang memanggil ".some()" agar tidak crash:
     if (!Array.isArray(B.value)) return;
4. Re-write logic yang menyebabkan B.value override menjadi object/string/null.
5. Berikan patch code final untuk seluruh file yang terlibat.

3 — Deep Scan Project Command (Untuk memastikan tidak ada titik lain yg rusak)

Gunakan jika error masih muncul atau kamu curiga datanya kacau di tempat lain:

TODO:
1. Scan seluruh project untuk penggunaan ".some()", ".map()", ".filter()".
2. Identifikasi semua variabel yang TIDAK dijamin array.
3. Perbaiki semua data flow yang berpotensi mengirim non-array ke operasi array.
4. Buat summary laporan akar masalah yang paling mungkin menyebabkan error.

4 — Hard Enforcement Command (supaya Cursor SERIUS memperbaiki)

Ini memaksa Cursor rewrite semua logic yang bikin data inkonsisten:

TODO:
Refactor seluruh flow data terkait variable B:
- Pastikan B punya tipe yang konsisten (array) di seluruh project.
- Hapus semua assignment yang membuat B.value berubah tipe.
- Tambahkan layer normalizer global sebelum state digunakan.
- Tambahkan TypeScript types/typedef agar IDE memperingatkan lebih awal.
- Tampilkan patch final yang sudah dibersihkan dan stabil.